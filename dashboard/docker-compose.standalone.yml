# Standalone Docker-Compose für den Setup-Wizard
# Startet das Dashboard ohne Abhängigkeiten für die Ersteinrichtung
#
# Verwendung:
#   docker compose -f docker-compose.standalone.yml up -d
#   Dann im Browser: http://<SERVER-IP>:3000/setup

services:
  dashboard:
    build: .
    container_name: deployr-dashboard
    restart: unless-stopped
    ports:
      - "3000:3000"
    volumes:
      # Docker Socket für Container-Management und Setup
      - /var/run/docker.sock:/var/run/docker.sock
      # Projekt-Verzeichnisse (read-write für Setup)
      - ../users:/app/users
      - ../scripts:/app/scripts
      - ../templates:/app/templates
      - ../infrastructure:/app/infrastructure
      # Config-Datei (wird beim Setup erstellt)
      - ../config.sh:/app/config.sh
      - ../.:/app/base
    environment:
      - NODE_ENV=production
      - SETUP_MODE=true
      # Temporäre Werte für den Start
      - DB_HOST=deployr-mariadb
      - DB_PORT=3306
      - DB_DATABASE=dashboard
      - DB_USERNAME=dashboard_user
      - DB_PASSWORD=setup_temp_password
      - SESSION_SECRET=setup-wizard-temp-secret
    networks:
      - deployr-network

networks:
  deployr-network:
    name: deployr-network
    driver: bridge
